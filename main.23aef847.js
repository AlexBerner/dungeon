parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"B/l8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.Tiles=Object.freeze({Blank:0,Wall:1,Floor:2,Door:3,StairsUp:4,StairsDown:5});
},{}],"U5Xy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Room=void 0;var e=function(){function e(e,i){for(var t=0;t<i.length;t++){var s=i[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(i,t,s){return t&&e(i.prototype,t),s&&e(i,s),i}}(),i=require("./tiles");function t(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var s=exports.Room=function(){function s(e,r){t(this,s),this.size={x:e,y:r},this.pos={x:0,y:0},this.tiles=[];for(var o=0;o<this.size.y;o++){for(var n=[],a=0;a<this.size.x;a++)0===o||o===this.size.y-1||0===a||a===this.size.x-1?n.push(i.Tiles.Wall):n.push(i.Tiles.Floor);this.tiles.push(n)}}return e(s,[{key:"hasStairs",value:function(){for(var e=0;e<this.size.y;e++)for(var t=0;t<this.size.x;t++)if(this.tiles[e][t]===i.Tiles.StairsDown||this.tiles[e][t]===i.Tiles.StairsUp)return!0;return!1}},{key:"getDoorLocations",value:function(){for(var e=[],t=0;t<this.size.y;t++)for(var s=0;s<this.size.x;s++)this.tiles[t][s]===i.Tiles.Door&&e.push({x:s,y:t});return e}}],[{key:"areConnected",value:function(e,t){for(var s=e.getDoorLocations(),r=0;r<s.length;r++){var o=s[r];if(o.x+=e.pos.x,o.y+=e.pos.y,o.x-=t.pos.x,o.y-=t.pos.y,!(o.x<0||o.x>t.size.x-1||o.y<0||o.y>t.size.y-1)&&t.tiles[o.y][o.x]===i.Tiles.Door)return!0}return!1}}]),s}();
},{"./tiles":"B/l8"}],"FO+Z":[function(require,module,exports) {
"use strict";function t(t,e){return Math.floor(Math.random()*(e-t)+t)}function e(e){return e[t(0,e.length)]}function r(t,e,r){return Math.min(Math.max(t,e),r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.rand=t,exports.randomElement=e,exports.clamp=r;
},{}],"+8F6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Dungeon=void 0;var o=function(){function o(o,s){for(var i=0;i<s.length;i++){var e=s[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,e.key,e)}}return function(s,i,e){return i&&o(s.prototype,i),e&&o(s,e),s}}(),s=require("./room"),i=require("./tiles"),e=require("./utils");function r(o,s){if(!(o instanceof s))throw new TypeError("Cannot call a class as a function")}var t=exports.Dungeon=function(){function t(o,s){r(this,t),this.size={x:o,y:s},this.minRoomSize=5,this.maxRoomSize=15,this.maxNumRooms=50,this.maxRoomArea=150,this.addStairsUp=!0,this.addStairsDown=!0,this.rooms=[],this.roomGrid=[]}return o(t,[{key:"getStairs",value:function(){for(var o={up:null,down:null},s=0;s<this.rooms.length;s++){var e=this.rooms[s];if(e.hasStairs())for(var r=0;r<e.size.y;r++)for(var t=0;t<e.size.x;t++)e.tiles[r][t]===i.Tiles.StairsUp?o.up={x:e.pos.x+t,y:e.pos.y+r}:e.tiles[r][t]===i.Tiles.StairsUp&&(o.down={x:e.pos.x+t,y:e.pos.y+r})}return o}},{key:"generate",value:function(){this.rooms=[],this.roomGrid=Array(this.size.y);for(var o=0;o<this.size.y;o++){for(var e=Array(this.size.x),r=0;r<this.size.x;r++)e[r]=[];this.roomGrid[o]=e}var t=this.createRandomRoom();t.pos={x:Math.floor(this.size.x/2)-Math.floor(t.size.x/2),y:Math.floor(this.size.y/2)-Math.floor(t.size.y/2)},this.addRoom(t);for(var a=5*this.maxNumRooms;(this.maxNumRooms<=0||this.rooms.length<this.maxNumRooms)&&a-- >0;)this.generateRoom();for(var n=0;n<this.rooms.length;n++)for(var h=this.getPotentiallyTouchingRooms(this.rooms[n]),y=0;y<h.length;y++)s.Room.areConnected(this.rooms[n],h[y])||Math.random()<.2&&this.addDoor(this.findNewDoorLocation(this.rooms[n],h[y]));this.addStairsDown&&this.addStairs(i.Tiles.StairsDown),this.addStairsUp&&this.addStairs(i.Tiles.StairsUp)}},{key:"getFlattenedTiles",value:function(){for(var o=Array(this.size.y),s=0;s<this.size.y;s++){o[s]=Array(this.size.x);for(var i=0;i<this.size.x;i++)o[s][i]=null}for(var e=0;e<this.rooms.length;e++)for(var r=this.rooms[e],t=0;t<r.size.y;t++)for(var a=0;a<r.size.x;a++)0!==r.tiles[t][a]&&(o[t+r.pos.y][a+r.pos.x]={type:r.tiles[t][a],hasBeenSeen:!1});return o}},{key:"getCollisionMap",value:function(){for(var o=Array(this.size.y),s=0;s<this.size.y;s++){o[s]=Array(this.size.x);for(var e=0;e<this.size.x;e++)o[s][e]=0}for(var r=0;r<this.rooms.length;r++)for(var t=this.rooms[r],a=0;a<t.size.y;a++)for(var n=0;n<t.size.x;n++){var h=0;switch(t.tiles[a][n]){case i.Tiles.Wall:h=1;break;case i.Tiles.StairsUp:h=2;break;case i.Tiles.StairsDown:h=3}o[a+t.pos.y][n+t.pos.x]=h}return o}},{key:"roomIntersect",value:function(o,s){var i=o.pos.x,e=o.pos.y,r=o.size.x,t=o.size.y,a=s.pos.x,n=s.pos.y,h=s.size.x,y=s.size.y;return!(i+r<=a+1||i>=a+h-1||e+t<=n+1||e>=n+y-1)}},{key:"canFitRoom",value:function(o){if(o.pos.x<0||o.pos.x+o.size.x>this.size.x-1)return!1;if(o.pos.y<0||o.pos.y+o.size.y>this.size.y-1)return!1;for(var s=0;s<this.rooms.length;s++){var i=this.rooms[s];if(this.roomIntersect(o,i))return!1}return!0}},{key:"getPotentiallyTouchingRooms",value:function(o){for(var s=[],i=function(i,e,r){for(var t=r[e][i],a=0;a<t.length;a++)if(t[a]!==o&&s.indexOf(t[a])<0){var n=i-t[a].pos.x,h=e-t[a].pos.y;(n>0&&n<t[a].size.x-1||h>0&&h<t[a].size.y-1)&&s.push(t[a])}},e=o.pos.x+1;e<o.pos.x+o.size.x-1;e++)i(e,o.pos.y,this.roomGrid),i(e,o.pos.y+o.size.y-1,this.roomGrid);for(var r=o.pos.y+1;r<o.pos.y+o.size.y-1;r++)i(o.pos.x,r,this.roomGrid),i(o.pos.x+o.size.x-1,r,this.roomGrid);return s}},{key:"findNewDoorLocation",value:function(o,s){var i={x:-1,y:-1},r=-1;switch(o.pos.y===s.pos.y-o.size.y+1?r=0:o.pos.x===s.pos.x-o.size.x+1?r=1:o.pos.x===s.pos.x+s.size.x-1?r=2:o.pos.y===s.pos.y+s.size.y-1&&(r=3),r){case 0:i.x=(0,e.rand)(Math.floor(Math.max(s.pos.x,o.pos.x)+1),Math.floor(Math.min(s.pos.x+s.size.x,o.pos.x+o.size.x)-1)),i.y=s.pos.y;break;case 1:i.x=s.pos.x,i.y=(0,e.rand)(Math.floor(Math.max(s.pos.y,o.pos.y)+1),Math.floor(Math.min(s.pos.y+s.size.y,o.pos.y+o.size.y)-1));break;case 2:i.x=o.pos.x,i.y=(0,e.rand)(Math.floor(Math.max(s.pos.y,o.pos.y)+1),Math.floor(Math.min(s.pos.y+s.size.y,o.pos.y+o.size.y)-1));break;case 3:i.x=(0,e.rand)(Math.floor(Math.max(s.pos.x,o.pos.x)+1),Math.floor(Math.min(s.pos.x+s.size.x,o.pos.x+o.size.x)-1)),i.y=o.pos.y}return i}},{key:"findRoomAttachment",value:function(o){var s=(0,e.randomElement)(this.rooms),i={x:0,y:0};switch((0,e.rand)(0,4)){case 0:i.x=(0,e.rand)(s.pos.x-o.size.x+3,s.pos.x+s.size.x-2),i.y=s.pos.y-o.size.y+1;break;case 1:i.x=s.pos.x-o.size.x+1,i.y=(0,e.rand)(s.pos.y-o.size.y+3,s.pos.y+s.size.y-2);break;case 2:i.x=s.pos.x+s.size.x-1,i.y=(0,e.rand)(s.pos.y-o.size.y+3,s.pos.y+s.size.y-2);break;case 3:i.x=(0,e.rand)(s.pos.x-o.size.x+3,s.pos.x+s.size.x-2),i.y=s.pos.y+s.size.y-1}return{position:i,target:s}}},{key:"addRoom",value:function(o){if(!this.canFitRoom(o))return!1;this.rooms.push(o);for(var s=o.pos.y;s<o.pos.y+o.size.y;s++)for(var i=o.pos.x;i<o.pos.x+o.size.x;i++){var e=this.roomGrid[s][i];e.push(o),this.roomGrid[s][i]=e}return!0}},{key:"addDoor",value:function(o){for(var s=this.roomGrid[o.y][o.x],e=0;e<s.length;e++){var r=s[e],t=o.x-r.pos.x,a=o.y-r.pos.y;r.tiles[a][t]=i.Tiles.Door}}},{key:"createRandomRoom",value:function(){var o=0,i=0,r=0;do{r=(o=(0,e.rand)(this.minRoomSize,this.maxRoomSize))*(i=(0,e.rand)(this.minRoomSize,this.maxRoomSize))}while(this.maxRoomArea>0&&r>this.maxRoomArea);return new s.Room(o,i)}},{key:"generateRoom",value:function(){for(var o=this.createRandomRoom(),s=150;s-- >0;){var i=this.findRoomAttachment(o);if(o.pos=i.position,this.addRoom(o)){this.addDoor(this.findNewDoorLocation(o,i.target));break}}}},{key:"addStairs",value:function(o){var s=null;do{s=(0,e.randomElement)(this.rooms)}while(s.getDoorLocations().length>1||s.hasStairs());for(var r=[],t=1;t<s.size.y-2;t++)for(var a=1;a<s.size.x-2;a++)s.tiles[t][a]===i.Tiles.Floor&&s.tiles[t-1][a]!==i.Tiles.Door&&s.tiles[t+1][a]!==i.Tiles.Door&&s.tiles[t][a-1]!==i.Tiles.Door&&s.tiles[t][a+1]!==i.Tiles.Door&&r.push({x:a,y:t});var n=(0,e.randomElement)(r);s.tiles[n.y][n.x]=o}}]),t}();
},{"./room":"U5Xy","./tiles":"B/l8","./utils":"FO+Z"}],"BSXI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.Keys=Object.freeze({Left:37,Up:38,Right:39,Down:40});
},{}],"hZZ8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Level=void 0;var e=function(){function e(e,i){for(var s=0;s<i.length;s++){var t=i[s];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(i,s,t){return s&&e(i.prototype,s),t&&e(i,t),i}}(),i=require("./dungeon"),s=require("./keys"),t=require("./tiles");function r(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var o=16,l=exports.Level=function(){function l(){r(this,l),this.dungeon=new i.Dungeon(100,100),this.dungeon.generate(),this.collisionMap=this.dungeon.getCollisionMap(),this.tiles=this.dungeon.getFlattenedTiles(),this.player={pos:{x:0,y:0},size:{x:12,y:12},speed:175,color:"#0CED13",onStairs:!0};var e=this.dungeon.getStairs();this.player.pos.x=e.up.x*o+o/2-this.player.size.x/2,this.player.pos.y=e.up.y*o+o/2-this.player.size.y/2}return e(l,[{key:"width",value:function(){return this.dungeon.size.x*o}},{key:"height",value:function(){return this.dungeon.size.y*o}},{key:"update",value:function(e,i){var r={x:0,y:0};s.Keys.Left in i&&(r.x-=this.player.speed*e),s.Keys.Right in i&&(r.x+=this.player.speed*e),s.Keys.Up in i&&(r.y-=this.player.speed*e),s.Keys.Down in i&&(r.y+=this.player.speed*e),this.player.pos=this.moveEntity(this.player.pos,this.player.size,r);for(var l=Math.floor((this.player.pos.x+this.player.size.x/2)/o),a=Math.floor((this.player.pos.y+this.player.size.y/2)/o),n=0,y=!1,h=this.dungeon.roomGrid[a][l],p=0;p<h.length;p++){var u=h[p],f=l-u.pos.x,x=a-u.pos.y;if(u.tiles[x][f]===t.Tiles.StairsUp&&(y=!0,!this.player.onStairs)){n=-1;break}if(u.tiles[x][f]===t.Tiles.StairsDown&&(y=!0,!this.player.onStairs)){n=1;break}}return this.player.onStairs=y,n}},{key:"isTileVisible",value:function(e,i,s,t,r){if("none"===e)return!0;if("room"===e){var o=this.dungeon.roomGrid[s][i];if(null!==o)for(var l=0;l<o.length;l++){var a=o[l];if(t>=a.pos.x&&t<a.pos.x+a.size.x&&r>=a.pos.y&&r<a.pos.y+a.size.y)return!0}}if("los"===e){if(i<0||i>=this.dungeon.size.x||t<0||t>=this.dungeon.size.x||s<0||s>=this.dungeon.size.y||r<0||r>=this.dungeon.size.y)return!0;for(var n=Math.abs(t-i),y=Math.abs(r-s),h=i<t?1:-1,p=s<r?1:-1,u=n-y;i!==t||s!==r;){if(1===this.collisionMap[s][i])return!1;var f=2*u;f>-y&&(u-=y,i+=h),f<n&&(u+=n,s+=p)}return!0}return!1}},{key:"draw",value:function(e,i,s,r){for(var l=Math.floor((this.player.pos.x+this.player.size.x/2)/o),a=Math.floor((this.player.pos.y+this.player.size.y/2)/o),n=Math.floor(s.x/o)-1,y=Math.floor(s.y/o)-1,h=(s.x%o+o)%o,p=(s.y%o+o)%o,u=-h-o,f=-p-o,x=e.width+o-h,c=e.height+o-p,d=y,v=f;v<c;d++,v+=o)if(!(d<0||d>=this.dungeon.size.y))for(var g=n,z=u;z<x;g++,z+=o)if(!(g<0||g>=this.dungeon.size.x)){var M=this.tiles[d][g];if(null!==M){var b=this.isTileVisible(r,l,a,g,d);if(b&&(M.HasBeenSeen=!0),M.HasBeenSeen){switch(M.type){case t.Tiles.Floor:case t.Tiles.Door:i.fillStyle=b?"#B8860B":"#705104";break;case t.Tiles.Wall:i.fillStyle=b?"#8B4513":"#61300D";break;case t.Tiles.StairsDown:i.fillStyle="#7A5A0D";break;case t.Tiles.StairsUp:i.fillStyle="#F2CD27"}i.fillRect(z,v,o,o)}}}i.fillStyle=this.player.color,i.fillRect(Math.floor(this.player.pos.x-s.x),Math.floor(this.player.pos.y-s.y),Math.floor(this.player.size.x),Math.floor(this.player.size.y))}},{key:"moveEntity",value:function(e,i,s){var r={x:e.x+s.x,y:e.y+s.y};if(s.x){var l=s.x>0?i.x:0,a=Math.floor((e.x+s.x+l)/o),n=Math.floor(e.y/o),y=Math.ceil((e.y+i.y)/o);if(y>=0&&n<this.dungeon.size.y&&a>=0&&a<this.dungeon.size.x)for(var h=n;h<y;h++)if(this.collisionMap[h][a]===t.Tiles.Wall){r.x=a*o-l+(s.x<0?o:0);break}}if(s.y){var p=s.y>0?i.y:0,u=Math.floor((e.y+s.y+p)/o),f=Math.floor(r.x/o),x=Math.ceil((r.x+i.x)/o);if(x>=0&&f<this.dungeon.size.x&&u>=0&&u<this.dungeon.size.y)for(var c=f;c<x;c++)if(this.collisionMap[u][c]===t.Tiles.Wall){r.y=u*o-p+(s.y<0?o:0);break}}return r}}]),l}();
},{"./dungeon":"+8F6","./keys":"BSXI","./tiles":"B/l8"}],"epB2":[function(require,module,exports) {
"use strict";var e=require("./level"),n=require("./keys"),t=[new e.Level],i=0,o={x:0,y:0},a={};window.addEventListener("keydown",function(e){for(var t in n.Keys)if(n.Keys[t]===e.keyCode)return a[e.keyCode]=!0,e.preventDefault&&e.preventDefault(),!0},!1),window.addEventListener("keyup",function(e){for(var t in n.Keys)if(n.Keys[t]===e.keyCode)return delete a[e.keyCode],e.preventDefault&&e.preventDefault(),!0},!1);var r="room",d=!1;function m(n){var r=t[i].update(n,a);-1===r?i>0&&i--:1===r&&(i===t.length-1&&t.push(new e.Level),i++);var d=document.getElementById("myCanvas"),m=t[i].player,u=m.pos.x+m.size.x/2,s=m.pos.y+m.size.y/2;o.x=Math.floor(u-d.width/2),o.y=Math.floor(s-d.height/2)}function u(){var e=document.getElementById("myCanvas"),n=e.getContext("2d");n.fillStyle="black",n.fillRect(0,0,e.width,e.height),t[i].draw(e,n,o,r),d&&(window.open(document.getElementById("myCanvas").toDataURL("image/png")),d=!1)}window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,n){window.setTimeout(e,1e3/60)}),document.getElementById("resetBtn").addEventListener("click",function(){t=[new e.Level],i=0,o={x:0,y:0},a={}}),document.getElementById("screenshotBtn").addEventListener("click",function(){d=!0});var s=Date.now();function w(){window.requestAnimationFrame(w);var e=Date.now(),n=(e-s)/1e3;s=e,m(n),u()}var l=document.getElementById("visibility");l.onchange=function(){r=l.options[l.selectedIndex].value},window.requestAnimationFrame(w);
},{"./level":"hZZ8","./keys":"BSXI"}]},{},["epB2"], null)